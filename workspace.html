<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Cargo Workspace - Rust &amp; Beyond: A Practical Exploration</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="ferris.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust &amp; Beyond: A Practical Exploration</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/xixiaofinland/rust_beyond" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="single-project-to-workspace"><a class="header" href="#single-project-to-workspace">Single Project to Workspace</a></h1>
<p>As you build projects in Rust, it's natural to start simple: a binary
(src/main.rs) or a library (src/lib.rs) sitting neatly in a single Cargo
project. But as your ideas grow, your project can benefit from a little more
structure.</p>
<p>In this chapter, we'll walk through the journey of evolving a simple Rust project
into a workspace. We'll see why you might want to do it, what changes are
involved, and what benefits you gain along the way. If you're curious about the
"next step" in organizing your Rust code, this is for you!</p>
<h2 id="the-starting-point-one-project-one-crate"><a class="header" href="#the-starting-point-one-project-one-crate">The Starting Point: One Project, One Crate</a></h2>
<p>Let's imagine you begin with a simple library and binary combined in one project:</p>
<pre><code>my-project/
|- Cargo.toml
|- src/
   |- lib.rs
   |- main.rs
</code></pre>
<p>The <code>Cargo.toml</code> declares both a library and a binary:</p>
<pre><code>[package]
name = "my-project"
version = "0.1.0"
edition = "2021"

[dependencies]

[lib]
path = "src/lib.rs"

[[bin]]
name = "my-project"
path = "src/main.rs"

</code></pre>
<p>You don't even need the <code>[lib]</code> and <code>[[bin]]</code> sections if you don't overwrite
the default settings in the sample above as the name is identical to the project
name.</p>
<p>This works beautifully for small programs. You can define reusable code in
<code>lib.rs,</code> and build your CLI, server, or app in <code>main.rs,</code> calling into the library.</p>
<p>But what if you want to:</p>
<ul>
<li>Add another binary (e.g., a CLI tool and a server)?</li>
<li>Create internal libraries that aren't part of the public API?</li>
</ul>
<p>You surely can still put all logic into the lib crate but how about separating
concerns more cleanly across crates? That's where workspaces shine!</p>
<h2 id="moving-to-a-workspace"><a class="header" href="#moving-to-a-workspace">Moving to a Workspace</a></h2>
<p>A Cargo workspace is a way to manage multiple related crates together. Think of
it like a "super-project" that coordinates building, testing, and managing
dependencies across multiple packages.</p>
<p>Let's transform our project step-by-step.</p>
<h3 id="create-a-cargotoml-for-the-workspace"><a class="header" href="#create-a-cargotoml-for-the-workspace">Create a Cargo.toml for the workspace</a></h3>
<p>Move the existing <code>Cargo.toml</code> into a new my-project/ sub-folder. Then, create a top-level <code>Cargo.toml</code>:</p>
<pre><code>[workspace]
members = [
    "crates/my-project-lib",
    "crates/my-project-cli",
]

</code></pre>
<p>The members list tells Cargo which packages belong to the workspace.</p>
<h3 id="split-the-code-into-crates"><a class="header" href="#split-the-code-into-crates">Split the code into crates</a></h3>
<p>We'll create two crates inside a new crates/ directory as implied in the above
workspace <code>Cargo.toml</code>.</p>
<pre><code>my-project/
|- Cargo.toml (workspace)
|- crates/
   |- my-project-lib/
      |- Cargo.toml
      |- src/
         |- lib.rs
   |- my-project-cli/
      |- Cargo.toml
      |- src/
         |- main.rs
</code></pre>
<p><code>my-project-lib</code> will hold the reusable library code, while <code>my-project-cli</code> will be
a binary crate depending on my-project-lib.</p>
<h3 id="update-the-crate-dependencies"><a class="header" href="#update-the-crate-dependencies">Update the crate dependencies</a></h3>
<p>In <code>crates/my-project-cli/Cargo.toml</code>:</p>
<pre><code>[package]
name = "my-project-cli"
version = "0.1.0"
edition = "2024"

[dependencies]
my-project-lib = { path = "../my-project-lib" }
</code></pre>
<p>Now your CLI crate can call into the library just like before. Spend some time
to put the code and tests into the corresponding crate. It's a good brain
excercise, with the help of <code>cargo build --workspace</code>, to define the clear crate
bundary which might not be the case before.</p>
<h2 id="why-bother"><a class="header" href="#why-bother">Why Bother?</a></h2>
<p>At first, moving to a workspace might feel like extra overhead. But it brings
powerful benefits, even for relatively small projects:</p>
<ul>
<li>Clear Separation of Concerns: Each crate focuses on a specific task. Your codebase becomes easier to understand and maintain.</li>
<li>Faster Builds: Cargo can rebuild only the crates that changed, rather than the entire project.</li>
<li>Multiple Binaries: You can easily add more binaries (tools, servers, utilities) alongside your main app.</li>
<li>Internal Libraries: Share code across multiple binaries without publishing it externally.</li>
<li>Testing in Isolation: You can run cargo test per-crate to get faster, more focused feedback.</li>
<li>Ready for Growth: When you eventually want to split parts into separate published crates (on crates.io) or keep internal libraries private, you're already halfway there.</li>
</ul>
<p>In short, workspaces help your project scale without becoming messy.</p>
<h2 id="a-natural-evolution"><a class="header" href="#a-natural-evolution">A Natural Evolution</a></h2>
<p>You don't have to start with a workspace when writing your first Rust project.
But when your project grows just a little—adding a second binary, needing some
internal shared code—workspaces offer a clean and powerful way to stay
organized.</p>
<p>The best part? Moving to a workspace is an incremental change. You can migrate a
project in stages, and Rust's tooling (Cargo) makes it smooth.</p>
<p>If you're curious, give it a try on your next project! You'll gain both clarity
and flexibility. In this small CLI project of mine:
<a href="https://github.com/xixiaofinland/jirun/tree/a0af5d6f76301ff278fac61a4f84e3c497730303">jirun</a>,
I have transferred it into workspace style to prepare for growing :)!</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="trait-common-traits.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="trait-common-traits.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>

        <script src="ace.js"></script>
        <script src="editor.js"></script>
        <script src="mode-rust.js"></script>
        <script src="theme-dawn.js"></script>
        <script src="theme-tomorrow_night.js"></script>

        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="ferris.js"></script>


    </div>
    </body>
</html>
